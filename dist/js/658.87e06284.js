"use strict";(self["webpackChunkdog_ui"]=self["webpackChunkdog_ui"]||[]).push([[658],{7359:function(e,l,a){a.d(l,{X:function(){return n}});var o=a(6980);const n=()=>{const e=(e,l)=>{l?o.z8.success(`${e}成功!`):o.z8.error(`${e}失败!`)};return{handleActionResult:e}}},3070:function(e,l,a){a.d(l,{A:function(){return n}});var o=a(6980);const n=({formRef:e,formDataHandler:l,formComp:a,shown:n,loading:t,action:r})=>{const i=async e=>{t.value=!0;const i=await a.value.onSubmit();if(l&&l(i),!i)return o.z8.error("请先完善表单信息!"),void(t.value=!1);const u="new"===r.value?await e.add(i):await e.update(i);u?(o.z8.success("保存成功"),n.value=!1):o.z8.error("保存失败"),t.value=!1},u=l=>{n.value=!0,e.value=l||{...e.value},r.value=l?"edit":"new"},d=()=>{e.value={},a.value.clearValidate(),r.value=null,t.value=!1},s=()=>{n.value=!1};return{onSubmit:i,onOpen:u,onClsoe:d,closeDialog:s}}},2878:function(e,l,a){a.d(l,{L:function(){return n}});const o={menu:{title:[{required:!0,message:"请输入标题!",trigger:"blur"}],order:[{required:!0,message:"请输入顺序!",trigger:"blur"}]},navigation:{menuId:[{required:!0,message:"请选择对应的菜单!",trigger:"change"}],description:[{required:!0,message:"请输入描述信息!",trigger:"blur"}],link:[{required:!0,message:"请输入导航链接!",trigger:"blur"}],openType:[{required:!0,message:"请选择打开链接的方式!",trigger:"change"}],title:[{required:!0,message:"请输入标题!",trigger:"blur"}],order:[{required:!0,message:"请输入顺序!",trigger:"blur"}]}},n=e=>{const l=()=>o[e];return{getFormRules:l}}},3662:function(e,l,a){a.d(l,{P:function(){return n}});var o=a(5382);const n=()=>{const e=e=>{console.log(e.link),window.open(e.prefix+e.link,"_blank")},l=e=>{e&&(e.indexOf("#")>-1?a(e):o.Z.push(e))},a=e=>{const l=document.getElementById(e);l&&l.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})};return{onNavLinkClick:e,onMenuClick:l}}},9665:function(e,l,a){a.d(l,{u:function(){return o}});const o=async e=>{try{const l=await e.value.validate();return l}catch(l){console.log(l)}}},7658:function(e,l,a){a.r(l),a.d(l,{default:function(){return B}});var o=a(2179),n=a(5905),t=a(3961),r=a(9421),i=a(6836),u=a(3070),d=a(4874),s=a(3539);const c=e=>s.e.get(`/menu/listNavigationByMenuId?menuId=${e}`),m=e=>s.e.post("/menu/insertNavigation",e),p=e=>s.e.post(`/menu/deleteNavigation?navigationId=${e}`),v=e=>s.e.post("/menu/updateNavigation",e);var g=a(8817),f=a(9608),w=a(89),y=a(6852),_=function(e,l,a,o){var n,t=arguments.length,r=t<3?l:null===o?o=Object.getOwnPropertyDescriptor(l,a):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,l,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(r=(t<3?n(r):t>3?n(l,a,r):n(l,a))||r);return t>3&&r&&Object.defineProperty(l,a,r),r};let b=class extends y.g4{constructor(...e){super(...e),(0,d.Z)(this,"loading",[])}async loadNavigations(e){this.NAV_LOADING(e,!0);const l=await c(e);this.NAV_LOADING(e,!1);const a=(0,f.u)(l,[]);return this.LOAD_NAVIGATIONS({menuId:e,navs:a}),a}async addNavigation(e){const l=await m(e);return this.loadNavigations(e.menuId),(0,f.u)(l,null)}async updateNavigation(e){const l=await v(e);return this.loadNavigations(e.menuId),(0,f.u)(l,null)}async removeNav(e){const l=await p(e.id);return this.loadNavigations(e.menuId),(0,f.u)(l,0)}LOAD_NAVIGATIONS({menuId:e,navs:l}){(0,w.isEmpty)(l)||g.h.commit("LOAD_NAVIGATION",{menuId:e,navs:l})}NAV_LOADING(e,l){this.loading[e]=l||void 0}};_([y.aU],b.prototype,"loadNavigations",null),_([y.aU],b.prototype,"addNavigation",null),_([y.aU],b.prototype,"updateNavigation",null),_([y.aU],b.prototype,"removeNav",null),_([y.mm],b.prototype,"LOAD_NAVIGATIONS",null),_([y.mm],b.prototype,"NAV_LOADING",null),b=_([(0,y.Yl)({dynamic:!0,store:g.h,name:"navigationStore"})],b);const U=(0,y.rT)(b);var k=a(1240),h=a(3004),S=a(2878),N=(0,o.aZ)({__name:"navigation-form",props:{form:Object},setup(e,{expose:l}){const a=e,{form:t}=(0,n.BK)(a),r=(0,n.iH)([]),u=(0,n.iH)([i.n1.HTTP,i.n1.HTTPS]),{getFormRules:d}=(0,S.L)("navigation"),s=(0,n.qj)(d()),c=async()=>{const e=await(0,k.je)();0===e.data.code&&(r.value=e.data.data)};return(0,o.wF)((()=>{c()})),l({form:t,rules:s}),(e,l)=>{const a=(0,o.up)("el-option"),i=(0,o.up)("el-select"),d=(0,o.up)("el-form-item"),s=(0,o.up)("el-input");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(d,{prop:"menuId",label:"菜单"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{modelValue:(0,n.SU)(t).menuId,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.SU)(t).menuId=e),class:"m-2",placeholder:"Select",size:"large"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.value,(e=>((0,o.wg)(),(0,o.j4)(a,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(d,{prop:"title",label:"标题"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{modelValue:(0,n.SU)(t).title,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,n.SU)(t).title=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(d,{prop:"description",label:"副标题"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{modelValue:(0,n.SU)(t).description,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,n.SU)(t).description=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(d,{prop:"order",label:"排序"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{modelValue:(0,n.SU)(t).order,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,n.SU)(t).order=e),type:"number"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(d,{prop:"link",label:"链接"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{modelValue:(0,n.SU)(t).link,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,n.SU)(t).link=e)},{prepend:(0,o.w5)((()=>[(0,o.Wm)(i,{modelValue:(0,n.SU)(t).prefix,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,n.SU)(t).prefix=e),class:"m-2",size:"large",style:{width:"100px"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(u.value,(e=>((0,o.wg)(),(0,o.j4)(a,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(d,{prop:"icon",label:"图标"},{default:(0,o.w5)((()=>[(0,o.Wm)(h.Z,{form:(0,n.SU)(t),uploadFolder:"navigation"},null,8,["form"])])),_:1})],64)}}}),V=a(7759);const I=(0,V.Z)(N,[["__scopeId","data-v-e193b7d8"]]);var W=I;const A={class:"menu-dialog-container"},C={class:"dialog-footer"},D=(0,o.Uk)("确认"),H=(0,o.Uk)("取消");var O=(0,o.aZ)({__name:"navigation-dialog",emits:["confirm"],setup(e,{expose:l}){const a=(0,n.iH)(null),t=(0,n.iH)(null),d=(0,n.iH)(!1),s=(0,n.iH)(!1);let c=(0,n.iH)("new");const m=(0,n.iH)({icon:i.QT,description:"",link:"",order:0,title:""}),p=e=>{e.link=e.prefix+e.link},{onSubmit:v,onOpen:g,onClsoe:f,closeDialog:w}=(0,u.A)({formRef:m,formDataHandler:p,formComp:a,shown:d,action:c,loading:s}),y=()=>v({add:e=>U.addNavigation(e),update:e=>U.updateNavigation(e)}),_=e=>g(e);return l({open:_}),(e,l)=>{const i=(0,o.up)("el-button"),u=(0,o.up)("el-dialog"),c=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.j4)(u,{modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=e=>d.value=e),title:"导航",onClose:(0,n.SU)(f)},{footer:(0,o.w5)((()=>[(0,o._)("span",C,[(0,o.Wm)(i,{type:"primary",onClick:y},{default:(0,o.w5)((()=>[D])),_:1}),(0,o.Wm)(i,{onClick:(0,n.SU)(w)},{default:(0,o.w5)((()=>[H])),_:1},8,["onClick"])])])),default:(0,o.w5)((()=>[(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",A,[(0,o.Wm)(r.Z,{ref_key:"formComp",ref:a,onConfirm:l[0]||(l[0]=l=>e.$emit("confirm",l.target.value)),form:t.value?.form,rules:t.value?.rules},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{ref_key:"navFormComp",ref:t,form:m.value},null,8,["form"])])),_:1},8,["form","rules"])])),[[c,s.value]])])),_:1},8,["modelValue","onClose"])}}});const T=O;var j=T,R=a(3662),F=a(7359),L=a(964),x=a(4726);const z={class:"menu-container el-card is-hover-shadow"},Z={class:"actions"},G=(0,o.Uk)("新增导航"),$=["src"],q=["onClick"];var P=(0,o.aZ)({__name:"navigation-manage",setup(e){const l=(0,n.iH)(null),a=(0,n.iH)(null),r=(0,n.Fl)((()=>L.v.menus)),u=(0,n.Fl)((()=>a?a.value?.navigationList:[])),d=(0,n.Fl)((()=>L.v.loading)),s=(0,n.iH)([]),c=i.NI,{handleActionResult:m}=(0,F.X)(),{onNavLinkClick:p}=(0,R.P)(),v=async()=>{(0,w.isEmpty)(L.v.menus)&&await L.v.loadMenus(),(0,w.isEmpty)(r.value)||(a.value=r.value[0])},g=async e=>{s[e.id]=!0;const l=await U.removeNav(e);m("删除",l),s[e.id]=!1},f=e=>{const o=e??{menuId:a.value.id,prefix:i.n1.HTTP};l.value.open(o)};return(0,o.wF)((async()=>{await v()})),(e,i)=>{const m=(0,o.up)("el-option"),v=(0,o.up)("el-select"),w=(0,o.up)("el-button"),y=(0,o.up)("el-table-column"),_=(0,o.up)("el-table"),b=(0,o.Q2)("loading");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",z,[(0,o._)("div",Z,[(0,o.Wm)(v,{modelValue:a.value,"onUpdate:modelValue":i[0]||(i[0]=e=>a.value=e),filterable:"","value-key":"id"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,n.SU)(r),(e=>((0,o.wg)(),(0,o.j4)(m,{key:e.id,label:e.title,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,o.Wm)(w,{type:"primary",onClick:i[1]||(i[1]=e=>f())},{default:(0,o.w5)((()=>[G])),_:1})]),(0,o.Wm)(_,{data:(0,n.SU)(u),stripe:"",style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{prop:"order",label:"顺序",width:"180"}),(0,o.Wm)(y,{prop:"icon",label:"图标",width:"180"},{default:(0,o.w5)((e=>[(0,o._)("img",{src:e.row.icon,width:"24",style:{color:"white"}},null,8,$)])),_:1}),(0,o.Wm)(y,{prop:"title",label:"导航名称",width:"180"}),(0,o.Wm)(y,{prop:"openType",label:"打开方式",width:"180"},{default:(0,o.w5)((e=>[(0,o.Uk)((0,t.zw)(e.row.openType===(0,n.SU)(c).TARGET_REDIRECTION?"新页面":"本页面"),1)])),_:1}),(0,o.Wm)(y,{prop:"link",label:"链接"},{default:(0,o.w5)((e=>[(0,o._)("a",{href:"javascript:void(0)",onClick:l=>(0,n.SU)(p)(e.row)},(0,t.zw)(e.row.link),9,q)])),_:1}),(0,o.Wm)(y,{fixed:"right",label:"Operations",width:"120"},{default:(0,o.w5)((e=>[(0,o.Wm)(w,{type:"primary",icon:(0,n.SU)(x.I8b),circle:"",onClick:l=>f(e.row)},null,8,["icon","onClick"]),(0,o.Wm)(w,{type:"danger",icon:(0,n.SU)(x.HG3),circle:"",onClick:l=>g(e.row),loading:s.value[e.row.id]},null,8,["icon","onClick","loading"])])),_:1})])),_:1},8,["data"])])),[[b,(0,n.SU)(d)]]),(0,o.Wm)(j,{ref_key:"navigationDialog",ref:l},null,512)],64)}}});const E=P;var B=E},3004:function(e,l,a){a.d(l,{Z:function(){return f}});var o=a(2179),n=a(5905),t=(a(2148),a(6980));const r=["imge/png","image/jpeg","image/jpg","image/gif"],i=e=>{const l=e=>r.includes(e.type)?(t.z8.error("上传文件格式不正确！"),!1):!(e.size/1024/1024>2)||(t.z8.error("文件大小最多2MB！"),!1),a=(l,a)=>{0===l.code?e.value.icon=l.data.path:t.z8.error("文件上传失败")};return{beforeAvatarUpload:l,onUploadSucceed:a}};var u=a(4726),d=a(6836),s=a(3121),c=a(8505);const m={class:"upload-container"},p=["src"];var v=(0,o.aZ)({__name:"doge-upload",props:{form:Object,uploadFolder:String},setup(e){const l=e,a=s.R["production"].baseUrl,t=s.R["production"].fileUrl,{form:r}=(0,n.BK)(l),v=(0,o.Fl)((()=>r?`${t}/${r.value.icon}`:d.QT)),g=(0,o.Fl)((()=>`${a}/file/${l.uploadFolder}/uploadFile`)),f={token:(0,c.LP)()},{beforeAvatarUpload:w,onUploadSucceed:y}=i(r);return(e,l)=>{const a=(0,o.up)("el-icon"),t=(0,o.up)("el-upload");return(0,o.wg)(),(0,o.iD)("div",m,[(0,o.Wm)(t,{class:"avatar-uploader",action:(0,n.SU)(g),"show-file-list":!1,"on-success":(0,n.SU)(y),"before-upload":(0,n.SU)(w),headers:f},{default:(0,o.w5)((()=>[(0,n.SU)(r).icon?((0,o.wg)(),(0,o.iD)("img",{key:0,src:(0,n.SU)(v),class:"avatar"},null,8,p)):((0,o.wg)(),(0,o.j4)(a,{key:1,class:"avatar-uploader-icon"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(u.v37))])),_:1}))])),_:1},8,["action","on-success","before-upload"])])}}});const g=v;var f=g},9421:function(e,l,a){a.d(l,{Z:function(){return d}});var o=a(2179),n=a(5905),t=a(9665),r=a(89),i=(0,o.aZ)({__name:"single-form",props:["form","rules"],setup(e,{expose:l}){const a=e,{form:i,rules:u}=(0,n.BK)(a),d=(0,n.iH)(),s=async()=>{const e=await(0,t.u)(d);return e?(0,r.cloneDeep)(i.value):null},c=()=>{d.value.clearValidate()};return l({onSubmit:s,clearValidate:c}),(e,l)=>{const a=(0,o.up)("el-form");return(0,o.wg)(),(0,o.j4)(a,{model:(0,n.SU)(i),rules:(0,n.SU)(u),"label-width":"120px",ref_key:"formRef",ref:d},{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"default")])),_:3},8,["model","rules"])}}});const u=i;var d=u}}]);
//# sourceMappingURL=658.87e06284.js.map